"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),s=new O(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var s=r.delegate;if(s){var a=k(s,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p={};function d(){}function f(){}function v(){}var y={};u(y,s,(function(){return this}));var m=Object.getPrototypeOf,_=m&&m(m(E([])));_&&_!==r&&o.call(_,s)&&(y=_);var g=v.prototype=d.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(t,r){function n(i,s,a,c){var u=h(t[i],t,s);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==e(p)&&o.call(p,"__await")?r.resolve(p.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):r.resolve(p).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(u.arg)}var i;this._invoke=function(e,t){function o(){return new r((function(r,o){n(e,t,r,o)}))}return i=i?i.then(o,o):o()}}function k(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=v,u(g,"constructor",v),u(v,"constructor",f),f.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},t.awrap=function(e){return{__await:e}},w(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var s=new b(l(e,r,n,o),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(g),u(g,c,"Generator"),u(g,s,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
p=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),s=new O(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var s=r.delegate;if(s){var a=k(s,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h={};function d(){}function f(){}function v(){}var y={};a(y,o,(function(){return this}));var m=Object.getPrototypeOf,_=m&&m(m(E([])));_&&_!==t&&r.call(_,o)&&(y=_);var g=v.prototype=d.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(o,i,s,a){var c=l(e[o],e,i);if("throw"!==c.type){var h=c.arg,p=h.value;return p&&"object"==u(p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(p).then((function(e){h.value=e,s(h)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function k(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=v,a(g,"constructor",v),a(v,"constructor",f),f.displayName=a(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,a(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},w(b.prototype),a(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var s=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(g),a(g,s,"Generator"),a(g,o,(function(){return this})),a(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}function m(e){var t=k();return function(){var r,n=x(e);if(t){var o=x(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _(this,r)}}function _(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){var t="function"==typeof Map?new Map:void 0;return w=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return b(e,arguments,x(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),S(n,e)},w(e)}function b(e,t,r){return b=k()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&S(o,r.prototype),o},b.apply(null,arguments)}function k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}Object.defineProperty(exports,"__esModule",{value:!0});var O,E,T,C,P,R,A="".concat("https://accounts.google.com/gsi","/client");!function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords"}(O||(O={})),function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch"}(E||(E={})),function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(T||(T={})),function(e){e.embedded="embedded",e.floating="floating"}(C||(C={})),function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(P||(P={})),function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL"}(R||(R={}));var L=function(e){y(r,w(Error));var t=m(r);function r(e,n){var o;return v(this,r),(o=t.call(this,e+"\n"+n)).message=e+"\n"+n,o.name="SDKAPIUnreachableError",o.details=n,Object.setPrototypeOf(g(o),r.prototype),o}return f(r)}(),j=function(e){y(r,w(Error));var t=m(r);function r(e,n){var o;return v(this,r),(o=t.call(this)).name="StytchSDKUsageError",o.message="Invalid call to ".concat(e,"\n")+n,o}return f(r)}(),D=function(e){y(r,w(Error));var t=m(r);function r(e){var n,o;v(this,r),(n=t.call(this)).name="StytchSDKSchemaError";var i=null===(o=e.body)||void 0===o?void 0:o.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return n.message="[400] Request does not match expected schema\n".concat(i),n}return f(r)}(),I=function(e){y(r,w(Error));var t=m(r);function r(e){var n;v(this,r),(n=t.call(this)).name="StytchSDKAPIError";var o=e.status_code,i=e.error_type,s=e.error_message,a=e.error_url,c=e.request_id;return n.error_type=i,n.error_message=s,n.error_url=a,n.request_id=c,n.status_code=o,n.message="[".concat(o,"] ").concat(i,"\n")+"".concat(s,"\n")+"See ".concat(a," for more information.\n")+(c?"request_id: ".concat(c,"\n"):""),n}return f(r)}(),M=function(){function e(){v(this,e)}return f(e,null,[{key:"marshall",value:function(e){return Object.assign(Object.assign({},e),{name:e.name,message:e.message,stack:e.stack})}},{key:"inflate",value:function(e,t){var r=new e(t);return Object.assign(r,t),Object.setPrototypeOf(r,e.prototype),r}},{key:"unmarshall",value:function(t){if("name"in t)switch(t.name){case"SDKAPIUnreachableError":return e.inflate(L,t);case"StytchSDKSchemaError":return e.inflate(D,t);case"StytchSDKAPIError":return e.inflate(I,t);case"TypeError":return e.inflate(TypeError,t);case"SyntaxError":return e.inflate(SyntaxError,t);case"ReferenceError":return e.inflate(ReferenceError,t);case"RangeError":return e.inflate(RangeError,t);case"EvalError":return e.inflate(EvalError,t);case"URIError":return e.inflate(URIError,t)}return e.inflate(Error,t)}}]),e}();function F(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function U(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var K,N=function(){function e(t){v(this,e),this.iframeURL=t,this.createIframe()}return f(e,[{key:"createIframe",value:function(){var e=document.querySelector('[src~="'.concat(this.iframeURL,'"]'));e?Z.warn("It looks like you're creating multiple copies of the Stytch client. This behavior is unsupported, and unintended side effects may occur. Make sure you are creating the Stytch client at the global level, and not inside a component's render function."):((e=document.createElement("iframe")).src=this.iframeURL,e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.border="0",document.body.appendChild(e)),"true"!==e.dataset.loaded?this.frame=new Promise((function(t){e.addEventListener("load",(function(){e.dataset.loaded="true",t(e)}),{once:!0})})):this.frame=Promise.resolve(e)}},{key:"call",value:function(e,t){return U(this,void 0,void 0,p().mark((function r(){var n,o,i=this;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.frame;case 2:return n=r.sent,o=new MessageChannel,r.abrupt("return",new Promise((function(r,s){var a;o.port1.onmessage=function(e){var t=e.data;o.port1.close(),t.success?r(t.payload):s(M.unmarshall(t.error))};var c={method:e,args:t};null===(a=n.contentWindow)||void 0===a||a.postMessage(c,i.iframeURL,[o.port2])})));case 5:case"end":return r.stop()}}),r,this)})))}}]),e}(),B=new Uint8Array(16);function W(){if(!K&&!(K="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return K(B)}var q=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function G(e){return"string"==typeof e&&q.test(e)}for(var H=[],V=0;V<256;++V)H.push((V+256).toString(16).substr(1));function J(e,t,r){var n=(e=e||{}).random||(e.rng||W)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(H[e[t+0]]+H[e[t+1]]+H[e[t+2]]+H[e[t+3]]+"-"+H[e[t+4]]+H[e[t+5]]+"-"+H[e[t+6]]+H[e[t+7]]+"-"+H[e[t+8]]+H[e[t+9]]+"-"+H[e[t+10]]+H[e[t+11]]+H[e[t+12]]+H[e[t+13]]+H[e[t+14]]+H[e[t+15]]).toLowerCase();if(!G(r))throw TypeError("Stringified UUID is invalid");return r}(n)}var z={};function Y(e,t){return U(this,void 0,void 0,p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===z[e]){r.next=2;break}return r.abrupt("return",z[e]);case 2:return z[e]=$(e,t),r.abrupt("return",z[e]);case 4:case"end":return r.stop()}}),r)})))}function $(e,t){return new Promise((function(r,n){var o=function(e){var t=function(e){return document.querySelectorAll('script[src="'.concat(e,'"]'))}(e);if(t[0])return t[0]}(e);if(o&&"true"===o.dataset.loaded)try{r(t())}catch(t){return n(new Error("".concat(e," already loaded, but module was not found in global scope: ").concat(t)))}var i=function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("async","true"),t.setAttribute("defer","true"),document.head.appendChild(t),t}(e);i.addEventListener("load",(function(){i.dataset.loaded="true";try{r(t())}catch(t){n(new Error("".concat(e," was loaded, but module was not found in global scope: ").concat(t)))}})),i.addEventListener("error",(function(t){n(new Error("".concat(e," could not be loaded: ").concat(t)))}))}))}var X=["[Stytch]"],Z={debug:function(){return false},log:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).log.apply(e,X.concat(r))},warn:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).warn.apply(e,X.concat(r))},error:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).error.apply(e,X.concat(r))}},Q="\nYou can find your public token at https://stytch.com/dashboard/api-keys.",ee=function(e){"string"!=typeof e?Z.warn("Public token is malformed. Expected a string, got ".concat(u(e),".").concat(Q)):""===e?Z.warn('Public token is malformed. Expected "public-token-...", got an empty string.'.concat(Q)):e.startsWith("public-token-")||Z.warn('Public token is malformed. Expected "public-token-...", got '.concat(e,".").concat(Q))},te=function(e){var t="StytchUIClient"===e?"import { createStytchUIClient } from '@stytch/nextjs/ui';\n    \nconst stytch = createStytchUIClient('public-token-...');\n":"import { createStytchHeadlessClient } from '@stytch/nextjs/ui';\n    \nconst stytch = createStytchHeadlessClient('public-token-...');\n";if("undefined"==typeof window)throw new Error("The ".concat(e," is not compatible with server-side environments.\nIf using nextjs, use the create").concat(e," method instead.\n```\n").concat(t,"\n```\n"))},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.KEYS_TO_EXCLUDE,r=void 0===t?[]:t,n=function e(t,n){return u(t)===u(n)&&(null===t||null===n?t===n:"object"===u(t)?Object.keys(t).length===Object.keys(n).length&&!Object.keys(t).some((function(e){return!(e in n)}))&&Object.entries(t).filter((function(e){var t=c(e,1)[0];return!r.includes(t)})).every((function(t){var r=c(t,2),o=r[0],i=r[1];return e(i,n[o])})):t===n)};return n},ne=function(e){var t={isString:function(r,n){if("string"!=typeof n)throw new j(e,r+" must be a string.");return t},isOptionalString:function(e,r){return void 0===r?t:t.isString(e,r)},isStringArray:function(r,n){if(!Array.isArray(n))throw new j(e,r+" must be an array of strings.");var o,i=a(n);try{for(i.s();!(o=i.n()).done;){if("string"!=typeof o.value)throw new j(e,r+" must be an array of strings.")}}catch(e){i.e(e)}finally{i.f()}return t},isNumber:function(r,n){if("number"!=typeof n)throw new j(e,r+" must be a number.");return t},isOptionalNumber:function(e,r){return void 0===r?t:t.isNumber(e,r)}};return t},oe=function(e){return F(e,["request_id","status_code"])},ie=function(e){return F(e,["__user"])};function se(e){var t=e.method,r=e.errorMessage,n=e.finalURL,o=e.basicAuthHeader,i=e.xSDKClientHeader,s=e.xSDKParentHostHeader,a=e.body;return U(this,void 0,void 0,p().mark((function e(){var c,u,l,h,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={Authorization:o,"Content-Type":"application/json","X-SDK-Client":i},s&&(c["X-SDK-Parent-Host"]=s),u={method:t,headers:c,body:a&&JSON.stringify(a)},e.prev=3,e.next=6,fetch(n,u);case 6:l=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),"Failed to fetch"!==e.t0.message){e.next=13;break}throw new L(r,"Unable to contact the Stytch servers. Are you online?");case 13:throw e.t0;case 14:if(200===l.status){e.next=27;break}return e.prev=15,e.next=18,l.json();case 18:h=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),new L(r,"Invalid or no response from server");case 24:if(!("body"in h||"params"in h||"query"in h)){e.next=26;break}throw new D(h);case 26:throw new I(h);case 27:return e.prev=27,e.next=30,l.json();case 30:return d=e.sent,e.abrupt("return",d.data);case 34:throw e.prev=34,e.t2=e.catch(27),new L(r,"Invalid response from the Stytch servers.");case 37:case"end":return e.stop()}}),e,null,[[3,9],[15,21],[27,34]])})))}var ae=function(){function e(t,r){var n=this;v(this,e),this._subscriptionService=t,this._headlessSessionClient=r,this._onSessionChange=function(e){e?n.scheduleBackgroundRefresh():n.cancelBackgroundRefresh()},this._reauthenticateWithBackoff=function(){var t=function(t){return function(r){return e.isUnrecoverableRecoverableError(r)?Promise.reject(r):new Promise((function(r){return setTimeout(r,e.timeoutForAttempt(t))})).then((function(){return n._headlessSessionClient.authenticate()}))}};return n._headlessSessionClient.authenticate().catch(t(0)).catch(t(1)).catch(t(2)).catch(t(3)).catch(t(4))},this.timeout=null,this._subscriptionService.subscribeToSession(this._onSessionChange)}return f(e,[{key:"performBackgroundRefresh",value:function(){var e=this;this._reauthenticateWithBackoff().then((function(){e.scheduleBackgroundRefresh()})).catch((function(){Z.warn("Session background refresh failed. Signalling to app that user is logged out."),e._subscriptionService.destroyState()}))}},{key:"scheduleBackgroundRefresh",value:function(){var t=this;this.cancelBackgroundRefresh(),this.timeout=setTimeout((function(){t.performBackgroundRefresh()}),e.REFRESH_INTERVAL_MS)}},{key:"cancelBackgroundRefresh",value:function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}],[{key:"timeoutForAttempt",value:function(e){return Math.floor(350*Math.random())-175+2e3*Math.pow(2,e)}},{key:"isUnrecoverableRecoverableError",value:function(e){return"unauthorized_credentials"===e.error_type||"user_unauthenticated"===e.error_type}}]),e}();ae.REFRESH_INTERVAL_MS=18e4;var ce=function(){function e(t){v(this,e),this.maxBatchSize=t.maxBatchSize,this.logEventURL=t.logEventURL,setInterval(this.flush.bind(this),t.intervalDurationMs),this.batch=[]}return f(e,[{key:"logEvent",value:function(e,t){this.batch.push({telemetry:e,event:t}),this.batch.length>=this.maxBatchSize&&this.flush()}},{key:"flush",value:function(){return U(this,void 0,void 0,p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.batch.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.batch,this.batch=[],e.prev=4,e.next=7,fetch(this.logEventURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,this,[[4,9]])})))}}]),e}(),ue=f((function e(t,r){var n=this;v(this,e),this._networkClient=t,this._subscriptionService=r,this.get=function(){return U(n,void 0,void 0,p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._networkClient.fetchSDK({url:"/users/me",errorMessage:"Failed to retrieve user info.",method:"GET"});case 2:return t=e.sent,r=oe(t),this._subscriptionService.updateUser(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})))},this.getSync=function(){return n._subscriptionService.getUser()},this.update=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/me",body:e,errorMessage:"Failed to update user.",method:"PUT"});case 2:return r=t.sent,n=oe(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteEmail=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/emails/".concat(e),errorMessage:"Failed to delete email.",method:"DELETE"});case 2:return r=t.sent,n=oe(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deletePhoneNumber=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/phone_numbers/".concat(e),errorMessage:"Failed to delete phone number.",method:"DELETE"});case 2:return r=t.sent,n=oe(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteTOTP=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/totps/".concat(e),errorMessage:"Failed to delete TOTP.",method:"DELETE"});case 2:return r=t.sent,n=oe(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteWebauthnRegistration=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/webauthn_registrations/".concat(e),errorMessage:"Failed to delete WebAuthn registration.",method:"DELETE"});case 2:return r=t.sent,n=oe(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))},this.onChange=function(e){return n._subscriptionService.subscribeToUser(e)}})),le=function(){function e(t,r){var n=this;v(this,e),this._networkClient=t,this._subscriptionService=r,this.getSync=function(){return n._subscriptionService.getSession()},this.onChange=function(e){return n._subscriptionService.subscribeToSession(e)},this.revoke=function(){return U(n,void 0,void 0,p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._networkClient.fetchSDK({url:"/sessions/revoke",errorMessage:"Error revoking session",method:"POST"});case 2:t=e.sent;try{this._subscriptionService.destroyState()}catch(e){}return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})))},this.authenticate=function(e){return U(n,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={session_duration_minutes:null==e?void 0:e.session_duration_minutes},t.next=4,this._networkClient.fetchSDK({url:"/sessions/authenticate",body:r,errorMessage:"Error authenticating session",method:"POST"});case 4:return n=t.sent,this._subscriptionService.updateState({session:n.session,user:n.user,session_token:n.session_token,session_jwt:n.session_jwt}),t.abrupt("return",ie(n));case 9:throw t.prev=9,t.t0=t.catch(0),this._subscriptionService.destroyState(),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])})))}}return f(e,[{key:"getTokens",value:function(){return this._subscriptionService.getTokens()}}]),e}(),he=Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),pe=function(){function e(t,r,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:he,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return Promise.resolve(void 0)};v(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._config=i,this.executeRecaptcha=s,this.email={loginOrCreate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return U(o,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,o=n.pkceRequiredForEmailMagicLinks,i=void 0,!o){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:i=r.sent;case 9:return r.t0=Object,r.t1=Object.assign({},t),r.t2=e,r.t3=i,r.next=15,this.executeRecaptcha();case 15:return r.t4=r.sent,r.t5={email:r.t2,code_challenge:r.t3,captcha_token:r.t4},s=r.t0.assign.call(r.t0,r.t1,r.t5),r.abrupt("return",this._networkClient.fetchSDK({url:"/magic_links/email/login_or_create",body:s,errorMessage:"Failed to send magic link",method:"POST"}));case 19:case"end":return r.stop()}}),r,this)})))},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return U(o,void 0,void 0,p().mark((function r(){var n,o,i,s,a,c;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,o=n.pkceRequiredForEmailMagicLinks,i=void 0,!o){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:i=r.sent;case 9:return r.t0=Object,r.t1=Object.assign({},t),r.t2=e,r.t3=i,r.next=15,this.executeRecaptcha();case 15:return r.t4=r.sent,r.t5={email:r.t2,code_challenge:r.t3,captcha_token:r.t4},s=r.t0.assign.call(r.t0,r.t1,r.t5),a=!!this._subscriptionService.getSession(),c=a?"/magic_links/email/send/secondary":"/magic_links/email/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:c,body:s,errorMessage:"Failed to send magic link",method:"POST"}));case 21:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t){return U(o,void 0,void 0,p().mark((function r(){var n,o,i;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return ne("stytch.magicLinks.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),o=Object.assign({token:e,code_verifier:null===(n=this._pkceManager.getPKPair())||void 0===n?void 0:n.code_verifier},t),r.next=4,this._networkClient.fetchSDK({url:"/magic_links/authenticate",body:o,errorMessage:"Failed to authenticate token.",method:"POST"});case 4:return i=r.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateState({session:i.session,user:i.user,session_token:i.session_token,session_jwt:i.session_jwt}),r.abrupt("return",ie(i));case 8:case"end":return r.stop()}}),r,this)})))}}return f(e,[{key:"getCodeChallenge",value:function(){return U(this,void 0,void 0,p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._pkceManager.getPKPair())){e.next=3;break}return e.abrupt("return",t.code_challenge);case 3:return e.next=5,this._pkceManager.startPKCETransaction();case 5:return t=e.sent,e.abrupt("return",t.code_challenge);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}(),de=f((function e(t,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)};v(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=o,this.sms={loginOrCreate:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:n}),r.abrupt("return",this._networkClient.fetchSDK({url:"/otps/sms/login_or_create",body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 5:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:n}),i=!!this._subscriptionService.getSession(),s=i?"/otps/sms/send/secondary":"/otps/sms/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:s,body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 7:case"end":return r.stop()}}),r,this)})))}},this.whatsapp={loginOrCreate:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:n}),r.abrupt("return",this._networkClient.fetchSDK({url:"/otps/whatsapp/login_or_create",body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 5:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:n}),i=!!this._subscriptionService.getSession(),s=i?"/otps/whatsapp/send/secondary":"/otps/whatsapp/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:s,body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 7:case"end":return r.stop()}}),r,this)})))}},this.email={loginOrCreate:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),r.abrupt("return",this._networkClient.fetchSDK({url:"/otps/email/login_or_create",body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 5:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return U(n,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,o=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),i=!!this._subscriptionService.getSession(),s=i?"/otps/email/send/secondary":"/otps/email/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:s,body:o,errorMessage:"Failed to send one time passcode",method:"POST"}));case 7:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t,r){return U(n,void 0,void 0,p().mark((function n(){var o,i;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return ne("stytch.otps.authenticate").isString("Code",e).isNumber("session_duration_minutes",r.session_duration_minutes),o=Object.assign({token:e,method_id:t},r),n.next=4,this._networkClient.fetchSDK({url:"/otps/authenticate",body:o,errorMessage:"Failed to authenticate token.",method:"POST"});case 4:return i=n.sent,this._subscriptionService.updateState({session:i.session,user:i.user,session_token:i.session_token,session_jwt:i.session_jwt}),n.abrupt("return",ie(i));case 7:case"end":return n.stop()}}),n,this)})))}})),fe=function(){function e(t,r,n,o,i){v(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._dynamicConfig=o,this._config=i,this.google={start:this.startOAuthFlow(E.Google)},this.apple={start:this.startOAuthFlow(E.Apple)},this.microsoft={start:this.startOAuthFlow(E.Microsoft)},this.github={start:this.startOAuthFlow(E.Github)},this.gitlab={start:this.startOAuthFlow(E.GitLab)},this.facebook={start:this.startOAuthFlow(E.Facebook)},this.discord={start:this.startOAuthFlow(E.Discord)},this.slack={start:this.startOAuthFlow(E.Slack)},this.amazon={start:this.startOAuthFlow(E.Amazon)},this.bitbucket={start:this.startOAuthFlow(E.Bitbucket)},this.linkedin={start:this.startOAuthFlow(E.LinkedIn)},this.coinbase={start:this.startOAuthFlow(E.Coinbase)},this.twitch={start:this.startOAuthFlow(E.Twitch)}}return f(e,[{key:"authenticate",value:function(e,t){return U(this,void 0,void 0,p().mark((function r(){var n,o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return ne("stytch.oauth.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),(n=this._pkceManager.getPKPair())||Z.warn("No code verifier found in local storage for OAuth flow.\nConsider using stytch.oauth.$provider.start() to add PKCE to your OAuth flows for added security.\nSee https://stytch.com/docs/oauth#guides_pkce for more information."),r.next=5,this._networkClient.fetchSDK({url:"/oauth/authenticate",method:"POST",body:Object.assign({token:e,code_verifier:null==n?void 0:n.code_verifier},t),errorMessage:"Failed to authenticate token"});case 5:return o=r.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateState({session:o.session,user:oe(o.__user),session_token:o.session_token,session_jwt:o.session_jwt}),r.abrupt("return",ie(o));case 9:case"end":return r.stop()}}),r,this)})))}},{key:"getBaseApiUrl",value:function(){return U(this,void 0,void 0,p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dynamicConfig;case 2:if(t=e.sent,!(r=t.cnameDomain)){e.next=6;break}return e.abrupt("return","https://".concat(r));case 6:if(!this._config.publicToken.includes("public-token-test")){e.next=8;break}return e.abrupt("return",this._config.testAPIURL);case 8:return e.abrupt("return",this._config.liveAPIURL);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"startOAuthFlow",value:function(e){var t=this;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.login_redirect_url,o=r.signup_redirect_url,i=r.custom_scopes;return U(t,void 0,void 0,p().mark((function t(){var r,s,a,c,u,l;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dynamicConfig;case 2:return r=t.sent,s=r.cnameDomain,a=r.pkceRequiredForOAuth,t.next=7,this.getBaseApiUrl();case 7:if(c=t.sent,this._networkClient.logEvent({name:"start_oauth_flow",details:{provider_type:e,custom_scopes:i,cname_domain:s,pkce:a}}),(u=new URL("".concat(c,"/v1/public/oauth/").concat(e,"/start"))).searchParams.set("public_token",this._config.publicToken),!a){t.next=18;break}return t.next=14,this._pkceManager.startPKCETransaction();case 14:l=t.sent,u.searchParams.set("code_challenge",l.code_challenge),t.next=19;break;case 18:this._pkceManager.clearPKPair();case 19:i&&(ne("startOAuthFlow").isStringArray("custom_scopes",i),u.searchParams.set("custom_scopes",i.join(" "))),n&&u.searchParams.set("login_redirect_url",n),o&&u.searchParams.set("signup_redirect_url",o),window.location.href=u.toString();case 23:case"end":return t.stop()}}),t,this)})))}}}]),e}(),ve=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)};v(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=n}return f(e,[{key:"authenticateStart",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r,n,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.cryptoWallets.authenticateStart").isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type),r=!!this._subscriptionService.getSession(),t.next=4,this.executeRecaptcha();case 4:return n=t.sent,o=r?"/crypto_wallets/authenticate/start/secondary":"/crypto_wallets/authenticate/start/primary",t.abrupt("return",this._networkClient.fetchSDK({url:o,method:"POST",errorMessage:"Failed to start wallet authentication.",body:{crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,captcha_token:n}}));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.cryptoWallets.authenticate").isString("signature",e.signature).isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this._networkClient.fetchSDK({url:"/crypto_wallets/authenticate",method:"POST",errorMessage:"Failed to authenticate.",body:{session_duration_minutes:e.session_duration_minutes,crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,signature:e.signature}});case 3:return r=t.sent,this._subscriptionService.updateState({session:r.session,user:oe(r.__user),session_token:r.session_token,session_jwt:r.session_jwt}),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))}}]),e}(),ye=function(){function e(t,r){v(this,e),this._networkClient=t,this._subscriptionService=r}return f(e,[{key:"create",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.totps.create").isNumber("expiration_minutes",e.expiration_minutes),t.next=3,this._networkClient.fetchSDK({url:"/totps",method:"POST",errorMessage:"Failed to create TOTP",body:{expiration_minutes:e.expiration_minutes}});case 3:return r=t.sent,this._subscriptionService.updateUser(r.__user),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.totps.authenticate").isNumber("session_duration_minutes",e.session_duration_minutes).isString("totp_code",e.totp_code),t.next=3,this._networkClient.fetchSDK({url:"/totps/authenticate",method:"POST",errorMessage:"Failed to authenticate TOTP",body:{session_duration_minutes:e.session_duration_minutes,totp_code:e.totp_code}});case 3:return r=t.sent,this._subscriptionService.updateState({session:r.session,user:r.__user,session_token:r.session_token,session_jwt:r.session_jwt}),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"recoveryCodes",value:function(){return U(this,void 0,void 0,p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._networkClient.fetchSDK({url:"/totps/recovery_codes",method:"POST",errorMessage:"Failed to retrieve recovery codes"}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"recover",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.totps.recover").isNumber("session_duration_minutes",e.session_duration_minutes).isString("recovery_code",e.recovery_code),t.next=3,this._networkClient.fetchSDK({url:"/totps/recover",method:"POST",errorMessage:"Failed to recover TOTP",body:{session_duration_minutes:e.session_duration_minutes,recovery_code:e.recovery_code}});case 3:return r=t.sent,this._subscriptionService.updateState({session:r.session,user:r.__user,session_token:r.session_token,session_jwt:r.session_jwt}),t.abrupt("return",ie(r));case 6:case"end":return t.stop()}}),t,this)})))}}]),e}();function me(e){for(var t="==".slice(0,(4-e.length%4)%4),r=e.replace(/-/g,"+").replace(/_/g,"/")+t,n=atob(r),o=new ArrayBuffer(n.length),i=new Uint8Array(o),s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return o}function _e(e){var t,r="",n=a(new Uint8Array(e));try{for(n.s();!(t=n.n()).done;){var o=t.value;r+=String.fromCharCode(o)}}catch(e){n.e(e)}finally{n.f()}return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ge(e,t,r){if("copy"===t)return r;if("convert"===t)return e(r);if(t instanceof Array)return r.map((function(r){return ge(e,t[0],r)}));if(t instanceof Object){for(var n={},o=0,i=Object.entries(t);o<i.length;o++){var s=c(i[o],2),a=s[0],u=s[1];if(u.derive){var l=u.derive(r);void 0!==l&&(r[a]=l)}if(a in r)null!=r[a]?n[a]=ge(e,u.schema,r[a]):n[a]=null;else if(u.required)throw new Error("Missing key: ".concat(a))}return n}}function we(e,t){return{required:!0,schema:e,derive:t}}function be(e){return{required:!0,schema:e}}function ke(e){return{required:!1,schema:e}}var Se={type:be("copy"),id:be("convert"),transports:ke("copy")},xe={appid:ke("copy"),appidExclude:ke("copy"),credProps:ke("copy")},Oe={appid:ke("copy"),appidExclude:ke("copy"),credProps:ke("copy")},Ee={publicKey:be({rp:be("copy"),user:be({id:be("convert"),name:be("copy"),displayName:be("copy")}),challenge:be("convert"),pubKeyCredParams:be("copy"),timeout:ke("copy"),excludeCredentials:ke([Se]),authenticatorSelection:ke("copy"),attestation:ke("copy"),extensions:ke(xe)}),signal:ke("copy")},Te={type:be("copy"),id:be("copy"),rawId:be("convert"),authenticatorAttachment:ke("copy"),response:be({clientDataJSON:be("convert"),attestationObject:be("convert"),transports:we("copy",(function(e){var t;return(null==(t=e.getTransports)?void 0:t.call(e))||[]}))}),clientExtensionResults:we(Oe,(function(e){return e.getClientExtensionResults()}))},Ce={mediation:ke("copy"),publicKey:be({challenge:be("convert"),timeout:ke("copy"),rpId:ke("copy"),allowCredentials:ke([Se]),userVerification:ke("copy"),extensions:ke(xe)}),signal:ke("copy")},Pe={type:be("copy"),id:be("copy"),rawId:be("convert"),authenticatorAttachment:ke("copy"),response:be({clientDataJSON:be("convert"),authenticatorData:be("convert"),signature:be("convert"),userHandle:be("convert")}),clientExtensionResults:we(Oe,(function(e){return e.getClientExtensionResults()}))};function Re(e){return ge(me,Ee,e)}function Ae(e){return ge(_e,Te,e)}function Le(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.create(Re(e));case 2:return r=t.sent,t.abrupt("return",Ae(r));case 4:case"end":return t.stop()}}),t)})))}function je(e){return ge(me,Ce,e)}function De(e){return ge(_e,Pe,e)}function Ie(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.get(je(e));case 2:return r=t.sent,t.abrupt("return",De(r));case 4:case"end":return t.stop()}}),t)})))}var Me=function(){function e(t,r){v(this,e),this._networkClient=t,this._subscriptionService=r}return f(e,[{key:"register",value:function(e){var t;return U(this,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return ne("stytch.webauthn.register").isOptionalString("domain",null==e?void 0:e.domain).isOptionalString("authenticator_type",null==e?void 0:e.authenticator_type),r.next=3,this._networkClient.fetchSDK({url:"/webauthn/register/start",method:"POST",errorMessage:"Failed to start WebAuthn registration",body:{domain:null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:window.location.hostname,authenticator_type:null==e?void 0:e.authenticator_type}});case 3:return n=r.sent,o=n.public_key_credential_creation_options,r.next=7,Le({publicKey:JSON.parse(o)});case 7:return i=r.sent,r.next=10,this._networkClient.fetchSDK({url:"/webauthn/register",method:"POST",errorMessage:"Failed to register WebAuthn device",body:{public_key_credential:JSON.stringify(i)}});case 10:return s=r.sent,this._subscriptionService.updateUser(s.__user),r.abrupt("return",ie(s));case 13:case"end":return r.stop()}}),r,this)})))}},{key:"authenticate",value:function(e){var t;return U(this,void 0,void 0,p().mark((function r(){var n,o,i,s;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return ne("stytch.webauthn.register").isOptionalString("domain",e.domain).isNumber("session_duration_minutes",e.session_duration_minutes),r.next=3,this._networkClient.fetchSDK({url:"/webauthn/authenticate/start",method:"POST",errorMessage:"Failed to start WebAuthn authentication",body:{domain:null!==(t=e.domain)&&void 0!==t?t:window.location.hostname}});case 3:return n=r.sent,o=n.public_key_credential_request_options,r.next=7,Ie({publicKey:JSON.parse(o)});case 7:return i=r.sent,r.next=10,this._networkClient.fetchSDK({url:"/webauthn/authenticate",method:"POST",errorMessage:"Failed to authenticate WebAuthn device",body:{public_key_credential:JSON.stringify(i),session_duration_minutes:e.session_duration_minutes}});case 10:return s=r.sent,this._subscriptionService.updateState({session:s.session,user:s.__user,session_token:s.session_token,session_jwt:s.session_jwt}),r.abrupt("return",ie(s));case 13:case"end":return r.stop()}}),r,this)})))}}]),e}(),Fe=Promise.resolve({pkceRequiredForPasswordResets:!1}),Ue=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fe,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return Promise.resolve(void 0)};v(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._config=o,this.executeRecaptcha=i}return f(e,[{key:"getCodeChallenge",value:function(){return U(this,void 0,void 0,p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._config;case 2:if(t=e.sent,t.pkceRequiredForPasswordResets){e.next=6;break}return e.abrupt("return",void 0);case 6:if(!(r=this._pkceManager.getPKPair())){e.next=9;break}return e.abrupt("return",r.code_challenge);case 9:return e.next=11,this._pkceManager.startPKCETransaction();case 11:return r=e.sent,e.abrupt("return",r.code_challenge);case 13:case"end":return e.stop()}}),e,this)})))}},{key:"create",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.create").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.executeRecaptcha();case 3:return r=t.sent,t.next=6,this._networkClient.fetchSDK({url:"/passwords",method:"POST",errorMessage:"Failed to create password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:r}});case 6:return n=t.sent,this._subscriptionService.updateState({session:n.session,user:n.user,session_token:n.session_token,session_jwt:n.session_jwt}),t.abrupt("return",ie(n));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.authenticate").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.executeRecaptcha();case 3:return r=t.sent,t.next=6,this._networkClient.fetchSDK({url:"/passwords/authenticate",method:"POST",errorMessage:"Failed to authenticate password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:r}});case 6:return n=t.sent,this._subscriptionService.updateState({session:n.session,user:n.user,session_token:n.session_token,session_jwt:n.session_jwt}),t.abrupt("return",ie(n));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmailStart",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r,n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.resetByEmailStart").isString("email",e.email).isOptionalString("login_redirect_url",e.login_redirect_url).isOptionalString("reset_password_redirect_url",e.reset_password_redirect_url).isOptionalNumber("reset_password_expiration_minutes",e.reset_password_expiration_minutes),t.next=3,this.getCodeChallenge();case 3:return r=t.sent,t.next=6,this.executeRecaptcha();case 6:return n=t.sent,t.abrupt("return",this._networkClient.fetchSDK({url:"/passwords/email/reset/start",method:"POST",errorMessage:"Failed to start password reset flow.",body:{email:e.email,login_redirect_url:e.login_redirect_url,reset_password_redirect_url:e.reset_password_redirect_url,reset_password_expiration_minutes:e.reset_password_expiration_minutes,code_challenge:r,captcha_token:n}}));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmail",value:function(e){var t;return U(this,void 0,void 0,p().mark((function r(){var n,o,i;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return ne("stytch.passwords.resetByEmail").isString("token",e.token).isString("password",e.password).isNumber("session_duration_minutes",e.session_duration_minutes),r.next=3,this.executeRecaptcha();case 3:return n=r.sent,o=null===(t=this._pkceManager.getPKPair())||void 0===t?void 0:t.code_verifier,r.next=7,this._networkClient.fetchSDK({url:"/passwords/email/reset",method:"POST",errorMessage:"Failed to reset password.",body:{token:e.token,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:n,code_verifier:o}});case 7:return i=r.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateState({session:i.session,user:i.user,session_token:i.session_token,session_jwt:i.session_jwt}),r.abrupt("return",ie(i));case 11:case"end":return r.stop()}}),r,this)})))}},{key:"resetByExistingPassword",value:function(e){return U(this,void 0,void 0,p().mark((function t(){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.resetByExistingPassword").isString("email",e.email).isString("existing_password",e.existing_password).isString("new_password",e.new_password),t.next=3,this._networkClient.fetchSDK({url:"/passwords/existing_password/reset",method:"POST",errorMessage:"Failed to reset password.",body:{email:e.email,existing_password:e.existing_password,new_password:e.new_password}});case 3:return r=t.sent,t.abrupt("return",ie(r));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resetBySession",value:function(e){return U(this,void 0,void 0,p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.resetBySession").isString("password",e.password),t.next=3,this._networkClient.fetchSDK({url:"/passwords/session/reset",method:"POST",errorMessage:"Failed to reset session.",body:{password:e.password}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"strengthCheck",value:function(e){return U(this,void 0,void 0,p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ne("stytch.passwords.strengthCheck").isOptionalString("email",e.email).isString("password",e.password),t.abrupt("return",this._networkClient.fetchSDK({url:"/passwords/strength_check",method:"POST",errorMessage:"Failed to check password strength.",body:{email:e.email,password:e.password}}));case 2:case"end":return t.stop()}}),t,this)})))}}]),e}();function Ke(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var Ne=function(){function e(t,r,n){o(this,e),this._publicToken=t,this._subscriptionDataLayer=r,this.baseURL=n,this.updateSessionToken=function(){return null},this.eventLogger=new ce({maxBatchSize:15,intervalDurationMs:800,logEventURL:this.buildSDKUrl("/events")})}return s(e,[{key:"logEvent",value:function(e){var t=e.name,r=e.details,n=e.error,o=void 0===n?{}:n;this.eventLogger.logEvent(this.createTelemetryBlob(),{public_token:this._publicToken,event_name:t,details:r,error_code:o.error_code,error_description:o.error_description,http_status_code:o.http_status_code})}},{key:"createTelemetryBlob",value:function(){var e,t;return{event_id:"event-id-".concat(J()),app_session_id:"app-session-id-".concat(J()),persistent_id:"persistent-id-".concat(J()),client_sent_at:(new Date).toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,stytch_user_id:null===(e=this._subscriptionDataLayer.user)||void 0===e?void 0:e.user_id,stytch_session_id:null===(t=this._subscriptionDataLayer.session)||void 0===t?void 0:t.session_id,app:{identifier:window.location.hostname},sdk:{identifier:"Stytch.js Javascript SDK",version:"0.4.6"}}}},{key:"fetchSDK",value:function(e){var t=e.url,r=e.body,o=e.errorMessage,i=e.method;return Ke(this,void 0,void 0,n().mark((function e(){var s,a,c,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._subscriptionDataLayer.readSessionCookie().session_token,a="Basic "+window.btoa(this._publicToken+":"+(s||this._publicToken)),c=window.btoa(JSON.stringify(this.createTelemetryBlob())),u=window.location.origin,e.abrupt("return",se({basicAuthHeader:a,body:r,errorMessage:o,finalURL:this.buildSDKUrl(t),method:i,xSDKClientHeader:c,xSDKParentHostHeader:u}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"buildSDKUrl",value:function(e){return"".concat(this.baseURL,"/sdk/v1").concat(e)}}]),e}();
/*! js-cookie v3.0.1 | MIT */
function Be(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var We=function e(t,r){function n(e,n,o){if("undefined"!=typeof document){"number"==typeof(o=Be({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in o)o[s]&&(i+="; "+s,!0!==o[s]&&(i+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+i}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");try{var a=decodeURIComponent(i[0]);if(n[a]=t.read(s,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",Be({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Be({},this.attributes,t))},withConverter:function(t){return e(Be({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),qe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat("stytch_sdk_state_").concat(e).concat(t?"::".concat(t):"")},Ge=function(){function e(t,r){var n=this;o(this,e),this.browserSessionStorage={getItem:function(e){return sessionStorage.getItem(qe(n.publicToken,e))},setItem:function(e,t){return sessionStorage.setItem(qe(n.publicToken,e),t)},removeItem:function(e){return sessionStorage.removeItem(qe(n.publicToken,e))}},this.publicToken=t,this.session=null,this.user=null,this.sessionSubscriptions={},this.userSubscriptions={},(null==r?void 0:r.cookieOptions)?(ne("SubscriptionDataLayer").isString("cookieOptions.opaqueTokenCookieName",r.cookieOptions.opaqueTokenCookieName).isString("cookieOptions.jwtCookieName",r.cookieOptions.jwtCookieName),this._jwtCookieName=r.cookieOptions.jwtCookieName,this._opaqueTokenCookieName=r.cookieOptions.opaqueTokenCookieName):(this._opaqueTokenCookieName=null,this._jwtCookieName=null);var i=localStorage.getItem(qe(this.publicToken));if(i){var s;try{s=JSON.parse(i)}catch(e){return this.syncToLocalStorage(),void this.removeSessionCookie()}var a=s,c=a.session,u=a.user;this.session=c,this.user=u}else this.removeSessionCookie()}return s(e,[{key:"opaqueTokenCookieName",get:function(){var e;return null!==(e=this._opaqueTokenCookieName)&&void 0!==e?e:"stytch_session"}},{key:"jwtCookieName",get:function(){var e;return null!==(e=this._jwtCookieName)&&void 0!==e?e:"stytch_session_jwt"}},{key:"readSessionCookie",value:function(){return{session_token:We.get(this.opaqueTokenCookieName),session_jwt:We.get(this.jwtCookieName)}}},{key:"writeSessionCookie",value:function(t){var r=t.session,n=t.session_token,o=t.session_jwt,i=e.generateCookieOpts(r.expires_at);We.set(this.opaqueTokenCookieName,n,i),We.set(this.jwtCookieName,o,i)}},{key:"removeSessionCookie",value:function(){var t=e.generateCookieOpts();We.remove(this.opaqueTokenCookieName,t),We.remove(this.jwtCookieName,t)}},{key:"syncToLocalStorage",value:function(){localStorage.setItem(qe(this.publicToken),JSON.stringify({session:this.session,user:this.user}))}},{key:"getItem",value:function(e){return localStorage.getItem(qe(this.publicToken,e))}},{key:"setItem",value:function(e,t){return localStorage.setItem(qe(this.publicToken,e),t)}},{key:"removeItem",value:function(e){return localStorage.removeItem(qe(this.publicToken,e))}}],[{key:"generateCookieOpts",value:function(e){var t={sameSite:"lax"};return e&&(t.expires=new Date(e)),Ye()?t.secure=!1:(t.domain=window.location.host,t.secure=!0),t}}]),e}(),He=Symbol.for("__stytch_DataLayer"),Ve=function(e,t){var r,n=((r=window)[He]||(r[He]={}),r[He]);return n[e]||(n[e]=new Ge(e,t)),n[e]},Je=function(e,t){var r=Math.random().toString(36).slice(-10);return e[r]=t,function(){return delete e[r]}},ze=function(e,t){Object.values(e).forEach((function(e){return e(t)}))},Ye=function(){return Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))},$e=re({KEYS_TO_EXCLUDE:["last_accessed_at"]}),Xe=re(),Ze=function(){function e(t,r){var n=this;o(this,e),this._publicToken=t,this._datalayer=r,this._listen=function(e){e.key===qe(n._publicToken)&&(null!==e.newValue?n._updateStateInternal(JSON.parse(e.newValue)):n.destroyState())},window.addEventListener("storage",this._listen);var i=this._datalayer.session;i&&Date.parse(i.expires_at)<Date.now()?this.destroyState():this._datalayer.readSessionCookie().session_token||this.destroyState()}return s(e,[{key:"getSession",value:function(){return this._datalayer.session}},{key:"getTokens",value:function(){var e=this._datalayer.readSessionCookie(),t=e.session_token,r=e.session_jwt;return t&&r?{session_token:t,session_jwt:r}:null}},{key:"destroyState",value:function(){this.updateState({session:null,user:null,session_token:null,session_jwt:null})}},{key:"_updateStateInternal",value:function(e){var t=e.session,r=e.user,n=this._datalayer.session,o=this._datalayer.user;this._datalayer.session=t,this._datalayer.user=r,$e(n,t)||ze(this._datalayer.sessionSubscriptions,t),Xe(o,r)||ze(this._datalayer.userSubscriptions,r)}},{key:"updateState",value:function(e){e.session?this._datalayer.writeSessionCookie(e):this._datalayer.removeSessionCookie(),this._updateStateInternal(e),this._datalayer.syncToLocalStorage()}},{key:"updateUser",value:function(e){var t=this._datalayer.user;this._datalayer.user=e,Xe(t,e)||(ze(this._datalayer.userSubscriptions,e),this._datalayer.syncToLocalStorage())}},{key:"subscribeToSession",value:function(e){return Je(this._datalayer.sessionSubscriptions,e)}},{key:"getUser",value:function(){return this._datalayer.user}},{key:"subscribeToUser",value:function(e){return Je(this._datalayer.userSubscriptions,e)}},{key:"destroy",value:function(){window.removeEventListener("storage",this._listen)}},{key:"syncFromDeviceStorage",value:function(){return null}}]),e}();function Qe(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t}var et=function(){function e(t){o(this,e),this._dataLayer=t}return s(e,[{key:"startPKCETransaction",value:function(){return Ke(this,void 0,void 0,n().mark((function t(){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createProofkeyPair();case 2:return r=t.sent,this._dataLayer.setItem("PKCE_VERIFIER",JSON.stringify(r)),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getPKPair",value:function(){var e=this._dataLayer.getItem("PKCE_VERIFIER");if(null!==e)try{return JSON.parse(e)}catch(e){return void Z.warn("Found malformed Proof Key pair in localstorage.")}}},{key:"clearPKPair",value:function(){return this._dataLayer.removeItem("PKCE_VERIFIER")}}],[{key:"createProofkeyPair",value:function(){return Ke(this,void 0,void 0,n().mark((function e(){var r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Uint32Array(16),window.crypto.getRandomValues(r),o=Array.from(r).map(Qe).join(""),e.next=5,window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(o));case 5:return i=e.sent,e.abrupt("return",{code_challenge:(n=i,s=void 0,btoa((s=String.fromCharCode).call.apply(s,[null].concat(t(new Uint8Array(n))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),code_verifier:o});case 7:case"end":return e.stop()}var n,s}),e)})))}}]),e}(),tt=function(){function e(t,r,n){var i=this;o(this,e),this._publicToken=t,this._networkClient=r,this._dataLayer=n,this._bootstrapDataPromise=this._networkClient.fetchSDK({url:"/projects/bootstrap/".concat(this._publicToken),method:"GET",errorMessage:"Error fetching bootstrap data for SDK for ".concat(this._publicToken)}).then(e.mapBootstrapData).then((function(e){return i._dataLayer.setItem("bootstrap",JSON.stringify(e)),e})).catch((function(e){return Z.error(e),{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1}}))}return s(e,[{key:"getSync",value:function(){var e=this._dataLayer.getItem("bootstrap");if(null===e)return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1};try{return JSON.parse(e)}catch(e){return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1}}}},{key:"getAsync",value:function(){return this._bootstrapDataPromise}}],[{key:"mapBootstrapData",value:function(e){return{displayWatermark:!e.disable_sdk_watermark,captchaSettings:e.captcha_settings,cnameDomain:e.cname_domain,emailDomains:e.email_domains,pkceRequiredForEmailMagicLinks:e.pkce_required_for_email_magic_links,pkceRequiredForPasswordResets:e.pkce_required_for_password_resets,pkceRequiredForOAuth:e.pkce_required_for_oauth}}}]),e}(),rt=s((function e(t){var r=this;o(this,e),this.bootstrapPromise=t,this.executeRecaptcha=function(){return Ke(r,void 0,void 0,n().mark((function e(){var t,r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.captchaClient,o=t.configured,i=t.siteKey,o){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,new Promise((function(e){return r.ready(e)}));case 10:return e.abrupt("return",r.execute(i,{action:"LOGIN"}));case 11:case"end":return e.stop()}}),e,this)})))},this.state=t.then((function(e){return Ke(r,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.captchaSettings.enabled){t.next=2;break}return t.abrupt("return",{configured:!1});case 2:return t.next=4,r=e.captchaSettings.siteKey,Y("https://www.google.com/recaptcha/enterprise.js?render=".concat(r),(function(){return window.grecaptcha.enterprise}));case 4:return t.t0=t.sent,t.t1=e.captchaSettings.siteKey,t.abrupt("return",{configured:!0,captchaClient:t.t0,siteKey:t.t1});case 7:case"end":return t.stop()}var r}),t)})))}))}));function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function it(e,t,r){return t&&ot(e.prototype,t),r&&ot(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ft(e,t)}function ct(e){var t=dt();return function(){var r,n=vt(e);if(t){var o=vt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ut(this,r)}}function ut(e,t){if(t&&("object"===nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lt(e)}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e){var t="function"==typeof Map?new Map:void 0;return ht=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return pt(e,arguments,vt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ft(n,e)},ht(e)}function pt(e,t,r){return pt=dt()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&ft(o,r.prototype),o},pt.apply(null,arguments)}function dt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ft(e,t){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ft(e,t)}function vt(e){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vt(e)}exports.Products=void 0,function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords"}(exports.Products||(exports.Products={})),exports.OAuthProviders=void 0,function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch"}(exports.OAuthProviders||(exports.OAuthProviders={})),exports.Wallets=void 0,function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(exports.Wallets||(exports.Wallets={})),exports.OneTapPositions=void 0,function(e){e.embedded="embedded",e.floating="floating"}(exports.OneTapPositions||(exports.OneTapPositions={})),exports.OTPMethods=void 0,function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(exports.OTPMethods||(exports.OTPMethods={})),exports.StytchEventType=void 0,function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL"}(exports.StytchEventType||(exports.StytchEventType={}));var yt=function(e){at(r,ht(Error));var t=ct(r);function r(e,n){var o;return st(this,r),(o=t.call(this,e+"\n"+n)).message=e+"\n"+n,o.name="SDKAPIUnreachableError",o.details=n,Object.setPrototypeOf(lt(o),r.prototype),o}return it(r)}(),mt=function(e){at(r,ht(Error));var t=ct(r);function r(e,n){var o;return st(this,r),(o=t.call(this)).name="StytchSDKUsageError",o.message="Invalid call to ".concat(e,"\n")+n,o}return it(r)}(),_t=function(e){at(r,ht(Error));var t=ct(r);function r(e){var n,o;st(this,r),(n=t.call(this)).name="StytchSDKSchemaError";var i=null===(o=e.body)||void 0===o?void 0:o.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return n.message="[400] Request does not match expected schema\n".concat(i),n}return it(r)}(),gt=function(e){at(r,ht(Error));var t=ct(r);function r(e){var n;st(this,r),(n=t.call(this)).name="StytchSDKAPIError";var o=e.status_code,i=e.error_type,s=e.error_message,a=e.error_url,c=e.request_id;return n.error_type=i,n.error_message=s,n.error_url=a,n.request_id=c,n.status_code=o,n.message="[".concat(o,"] ").concat(i,"\n")+"".concat(s,"\n")+"See ".concat(a," for more information.\n")+(c?"request_id: ".concat(c,"\n"):""),n}return it(r)}(),wt=function(){function e(t,r,n){o(this,e),this._googleClient=t,this._publicToken=r,this._clientId=n}return s(e,[{key:"cancel",value:function(){this._googleClient.cancel()}},{key:"render",value:function(e){var t=e.callback,r=e.onOneTapCancelled,o=e.style;return Ke(this,void 0,void 0,n().mark((function e(){var i,s=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={client_id:this._clientId,callback:t,auto_select:!1,context:"use",itp_support:!0},o.position===exports.OneTapPositions.embedded&&(i.prompt_parent_id="google-parent-prompt",i.cancel_on_tap_outside=!1),this._googleClient.initialize(i),e.abrupt("return",new Promise((function(e){s._googleClient.prompt((function(t){return t.isSkippedMoment()?("user_cancel"===t.getSkippedReason()&&r(),e({success:!1,reason:t.getSkippedReason()})):t.isNotDisplayed()?e({success:!1,reason:t.getNotDisplayedReason()}):(s.styleFrame(o),e({success:!0}))}))})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"styleFrame",value:function(e){e.position===exports.OneTapPositions.embedded&&Array.from(document.getElementsByTagName("iframe")).forEach((function(e){e.src.includes("https://accounts.google.com/gsi")&&(e.style.width="100%")}))}}]),e}(),bt=function(){function e(t,r){var i=this;o(this,e),this._publicToken=t,this.clientsideServices=r,this.createOnSuccessHandler=function(e){var t=e.loginRedirectUrl,r=e.signupRedirectUrl,o=e.onSuccess;return function(e){return Ke(i,void 0,void 0,n().mark((function i(){var s,a,c;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.credential,n.next=3,this.submitGoogleOneTapToken({credential:s,loginRedirectUrl:t,signupRedirectUrl:r});case 3:a=n.sent,c=a.redirect_url,o(c);case 6:case"end":return n.stop()}}),i,this)})))}},this.RedirectOnSuccess=function(e){window.location.href=e}}return s(e,[{key:"createOneTapClient",value:function(){return Ke(this,void 0,void 0,n().mark((function e(){var t,r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchGoogleStart();case 3:r=e.sent,t=r.googleClientId,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),o=e.t0,e.abrupt("return",{success:!1,reason:o.error_type});case 11:if(""!==t){e.next=13;break}return e.abrupt("return",{success:!1,reason:"oauth_config_not_found"});case 13:return e.t1=wt,e.next=16,Y(A,(function(){return window.google.accounts.id}));case 16:return e.t2=e.sent,e.t3=this._publicToken,e.t4=t,i=new e.t1(e.t2,e.t3,e.t4),e.abrupt("return",{success:!0,client:i});case 21:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"fetchGoogleStart",value:function(){return this.googleConfig||(this.googleConfig=this.clientsideServices.oneTapStart({publicToken:this._publicToken})),this.googleConfig}},{key:"submitGoogleOneTapToken",value:function(e){var t=e.credential,r=e.loginRedirectUrl,o=e.signupRedirectUrl;return Ke(this,void 0,void 0,n().mark((function e(){var i,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGoogleStart();case 2:return i=e.sent,s=i.oauthCallbackId,e.abrupt("return",this.clientsideServices.oneTapSubmit({publicToken:this._publicToken,idToken:t,loginRedirectURL:r,oauthCallbackID:s,signupRedirectURL:o}));case 5:case"end":return e.stop()}}),e,this)})))}}],[{key:"WillGoogleOneTapShowBannerForUA",value:function(e){var t=function(e,t){return-1!==e.indexOf(t)},r=t(e,"iPad")||t(e,"Android")&&!t(e,"Mobile")||t(e,"Silk"),n=t(e,"iPod")||t(e,"iPhone")||t(e,"Android")||t(e,"IEMobile");return!r&&n}},{key:"WillGoogleOneTapShowEmbedded",value:function(){return!e.WillGoogleOneTapShowBannerForUA(navigator.userAgent)}}]),e}(),kt=Symbol.for("stytch__internal"),St=function(e,t){Object.assign(e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},kt,t))},xt=function(){function e(t){var r=this;o(this,e),this.iframeURL=t,this.oneTapStart=function(e){return r.call("oneTapStart",e)},this.oneTapSubmit=function(e){return r.call("oneTapSubmit",e)}}return s(e,[{key:"frameClient",get:function(){var e;return this._frameClient=null!==(e=this._frameClient)&&void 0!==e?e:new N(this.iframeURL),this._frameClient}},{key:"call",value:function(e,t){return this.frameClient.call(e,[t])}}]),e}(),Ot=function(){function e(t){o(this,e),this._networkClient=t}return s(e,[{key:"search",value:function(e){return this._networkClient.fetchSDK({url:"/users/search",method:"POST",body:{email:e},errorMessage:"Error searching for user ".concat(e)})}}]),e}(),Et=s((function e(t){o(this,e);var r=arguments[1];te("StytchHeadlessClient"),ee(t);var n=Tt(r);this._dataLayer=Ve(t,r),this._subscriptionService=new Ze(t,this._dataLayer),this._networkClient=new Ne(t,this._dataLayer,n.endpoints.sdkBackendURL),this._pkceManager=new et(this._dataLayer);var i=new tt(t,this._networkClient,this._dataLayer),s=new rt(i.getAsync()),a=new xt(n.endpoints.clientsideServicesIframeURL),c=new bt(t,a),u=new Ot(this._networkClient);this.user=new ue(this._networkClient,this._subscriptionService),this.session=new le(this._networkClient,this._subscriptionService),this.magicLinks=new pe(this._networkClient,this._subscriptionService,this._pkceManager,i.getAsync(),s.executeRecaptcha),this.otps=new de(this._networkClient,this._subscriptionService,s.executeRecaptcha),this.oauth=new fe(this._networkClient,this._subscriptionService,this._pkceManager,i.getAsync(),{publicToken:t,testAPIURL:n.endpoints.testAPIURL,liveAPIURL:n.endpoints.liveAPIURL}),this.cryptoWallets=new ve(this._networkClient,this._subscriptionService,s.executeRecaptcha),this.totps=new ye(this._networkClient,this._subscriptionService),this.webauthn=new Me(this._networkClient,this._subscriptionService),this.passwords=new Ue(this._networkClient,this._subscriptionService,this._pkceManager,i.getAsync(),s.executeRecaptcha),this._sessionManager=new ae(this._subscriptionService,this.session),this._dataLayer.readSessionCookie().session_token&&this._sessionManager.performBackgroundRefresh(),this._networkClient.logEvent({name:"sdk_instance_instantiated",details:{event_callback_registered:!1,error_callback_registered:!1,success_callback_registered:!1}}),St(this,{bootstrap:i,clientsideServices:a,captcha:s,oneTap:c,userSearch:u,publicToken:t})}));function Tt(e){var t,r,n,o,i,s,a,c;return{cookieOptions:null==e?void 0:e.cookieOptions,endpoints:{sdkBackendURL:null!==(r=null===(t=null==e?void 0:e.endpoints)||void 0===t?void 0:t.sdkBackendURL)&&void 0!==r?r:"https://web.stytch.com",testAPIURL:null!==(o=null===(n=null==e?void 0:e.endpoints)||void 0===n?void 0:n.testAPIURL)&&void 0!==o?o:"https://test.stytch.com",liveAPIURL:null!==(s=null===(i=null==e?void 0:e.endpoints)||void 0===i?void 0:i.liveAPIURL)&&void 0!==s?s:"https://api.stytch.com",clientsideServicesIframeURL:null!==(c=null===(a=null==e?void 0:e.endpoints)||void 0===a?void 0:a.clientsideServicesIframeURL)&&void 0!==c?c:"https://js.stytch.com/clientside-services/index.html"}}}exports.SDKAPIUnreachableError=yt,exports.StytchHeadlessClient=Et,exports.StytchSDKAPIError=gt,exports.StytchSDKSchemaError=_t,exports.StytchSDKUsageError=mt;
